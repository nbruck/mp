<html t:type="mainLayout"
      p:title="message:meta.title"
      p:robot="literal:noxindex,nofollow"
      p:navigation="prop:navigation"
      xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd"
      xmlns:p="tapestry:parameter">

    <div id="resultpage">
        <div class="wrapper round boxShadow">
            <t:if test="mileageResultAvailable"/>

            <t:if test="errorMessage">
                <h2>${prop:errorMessage}</h2>

                <t:backtomainpage/>
            </t:if>

            <t:delegate to="prop:activeBlock"/>
        </div>
    </div>

    <t:block t:id="viewOnlyBlock">
        <t:if test="otherMessage">
            <h2>
                ${prop:otherMessage}
            </h2>
        </t:if>
        <t:if test="mileageResultAvailable">
            <div id="result">
                <t:resultRenderer showCarTrustLevel="prop:showTrustLevelOfCarData" storingDate="prop:storingDate"/>

                <t:backtomainpage/>
            </div>
        </t:if>
    </t:block>

    <t:block t:id="newCarBlock">
        <!-- here we can decide if we want to show trustlevel and different messages -->
            <h2>
                ${message:success.mileage.stored}
            </h2>

        <t:delegate to="block:sharedBlockForNewAndNoRegdate"/>
    </t:block>

    <t:block t:id="noRegdateStoredBeforeBlock">
            <h2>
                ${message:success.mileage.updated}
            </h2>

        <t:delegate to="block:sharedBlockForNewAndNoRegdate"/>
    </t:block>

    <t:block t:id="sharedBlockForNewAndNoRegdate">
        <span>
            <t:outputRaw value="message:success.mileage.stored.optional"/>
        </span>
        <br/>
        <br/>
        <br/>
        <t:registrationDateComponent t:buttonBlock="block:yesOrNoButtonBlock"/>
    </t:block>

    <t:block t:id="regDateStoredBeforeBlock">
        <h2>
            ${message:success.mileage.updated}
        </h2>
        <t:delegate to="block:viewOnlyBlock"/>
    </t:block>

    <t:block t:id="yesOrNoButtonBlock">
        <t:submit t:id="yesStore" value="message:submit.yes-store.txt" class="round"/>
        <t:submit t:id="noThankYou" value="message:submit.no-thank-you.txt" class="round"/>
    </t:block>

    <t:block t:id="fallbackBlock">
        <t:trigger event="gotoErrorPage"/>
    </t:block>

</html>
